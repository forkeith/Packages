# SYNTAX TEST "Packages/XML/Snippet.sublime-syntax"
<snippet>
    <content><![CDATA[
#   ^^^^^^^^^ meta.tag
#    ^^^^^^^ entity.name.tag.localname
#   ^ punctuation.definition.tag.begin
#           ^ punctuation.definition.tag.end
#            ^^^^^^^^^^ string.unquoted.cdata - meta.tag
#            ^^^^^^^^^ punctuation.definition.string.begin

      Original: ${1:Hey, Joe!}
#               ^^^^^^^^^^^^^^ meta.text-substitution
#              ^ - meta.text-substitution
#                             ^ - meta.text-substitution
#               ^^ keyword.other.caret
#                 ^ constant.numeric
#                  ^ keyword.operator.alternation
#                            ^ keyword.other.caret

Transformation: ${1/./=/g}
#               ^^^^^^^^^^ meta.text-substitution
#              ^ - meta.text-substitution
#                         ^ - meta.text-substitution
#               ^^ keyword.other.caret
#                 ^ constant.numeric
#                  ^ keyword.operator.regexp.begin
#                   ^ keyword.other.any
#                    ^ keyword.operator.regexp.end
#                      ^ keyword.operator.replacement.end
#                       ^ storage.modifier.mode.regexp
#                        ^ keyword.other.caret

Transformation: ${1/^(\w)|(?:_(\w))/(?1\u$1:)(?2 \u${2}:)/g}
#               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.text-substitution
#              ^ - meta.text-substitution
#                                                           ^ - meta.text-substitution
#               ^^ keyword.other.caret
#                 ^ constant.numeric
#                  ^ keyword.operator.regexp.begin
#                   ^ keyword.control.anchors
#                    ^^^^ meta.group
#                     ^^ keyword.control.character-class
#                        ^ keyword.operator.alternation
#                         ^^^^^^^^^ meta.group
#                                  ^ keyword.operator.regexp.end
#                                   ^^^^^^^^^ meta.group.conditional
#                                   ^^^ keyword.other.backref-and-recursion.conditional
#                                      ^^ keyword.operator.case-conversion
#                                        ^^ keyword.other.backref-and-recursion
#                                          ^ keyword.operator.alternation
#                                           ^ keyword.other.backref-and-recursion.conditional
#                                            ^^^ keyword.other.backref-and-recursion.conditional
#                                                ^^ keyword.operator.case-conversion
#                                                  ^^^^ keyword.other.backref-and-recursion
#                                                      ^ keyword.operator.alternation
#                                                       ^ keyword.other.backref-and-recursion.conditional
#                                                        ^ keyword.operator.replacement.end
#                                                         ^ storage.modifier.mode.regexp
#                                                          ^ keyword.other.caret

      Original: ${1:text_in_snail_case}
#               ^^ keyword.other.caret
#                 ^ constant.numeric
#                  ^ keyword.operator.alternation
#                                     ^ keyword.other.caret

First Name: ${1:Joe}
Second Name: ${2:Bloggs}
Address: ${3:Main Street 1234}
User name: ${4:$TM_FULLNAME}
#          ^^^^^^^^^^^^^^^^^ meta.text-substitution
#         ^ - meta.text-substitution
#                           ^ - meta.text-substitution
#          ^^ keyword.other.caret
#            ^ constant.numeric
#             ^ keyword.operator.alternation
#              ^ keyword.other.caret
#               ^^^^^^^^^^^ constant.language
#                          ^ keyword.other.caret

Test: ${1:Nested ${2:Placeholder}}
#     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.text-substitution
#                ^^^^^^^^^^^^^^^^ meta.text-substitution meta.text-substitution
#    ^ - meta.text-substitution
#                                 ^ - meta.text-substitution
#     ^^ keyword.other.caret
#       ^ constant.numeric
#        ^ keyword.operator.alternation
#                ^^ keyword.other.caret
#                  ^ constant.numeric
#                   ^ keyword.operator.alternation
#                               ^^ keyword.other.caret

No braces: $1 $SELECTION
#          ^ keyword.other.caret
#           ^ constant.numeric
#             ^ keyword.other.caret
#              ^^^^^^^^^ constant.language

Literal dollar: \$5
#               ^^ constant.character.escape - keyword
#                 ^ - constant.numeric

\label{sec:${TM_FILENAME:${SELECTION/(?i:(?<example>รก))|\\\w+\{(.*?)\}|\\(.)|(\w)|([^\w\\]+)/(?{5}_:\L$2${3}(?{example}a:\4)\E)/g}}}
#     ^ - keyword
#         ^ - keyword
#          ^ keyword.other.caret
#           ^ keyword.other.caret.begin
#            ^^^^^^^^^^^ constant.language
#                       ^ keyword.operator.alternation
#                        ^ keyword.other.caret
#                         ^ keyword.other.caret.begin
#                          ^^^^^^^^^ constant.language
#                                   ^ keyword.operator.regexp.begin
#                                    ^^^^^^^^^^^^^^^^^^ meta.group
#                                                       ^^ constant.character.escape
#                                                           ^ keyword.operator.quantifier.regexp
#                                                            ^^ constant.character.escape - keyword
#                                                                   ^^ constant.character.escape - keyword
#                                                                                           ^ keyword.operator.regexp.end
#                                                                                            ^^^^^ keyword.other.backref-and-recursion.conditional
#                                                                                                 ^ meta.literal
#                                                                                                  ^ keyword.operator.alternation
#                                                                                                   ^^ keyword.operator.case-conversion
#                                                                                                     ^^ keyword.other.backref-and-recursion
#                                                                                                           ^^^^^^^^^^^ keyword.other.backref-and-recursion.conditional
#                                                                                                                      ^ meta.literal - keyword.other.backref-and-recursion.conditional
#                                                                                                                        ^^ keyword.other.backref-and-recursion
#                                                                                                                           ^^ keyword.operator.case-conversion
#                                                                                                                              ^ keyword.operator.replacement.end
#                                                                                                                                ^^ keyword.other.caret.end
#                                                                                                                                  ^ - keyword

stray brackets:
 ${1/example)/)$$$0\\ \../}
#^ keyword.other.caret
# ^ keyword.other.caret.begin
#           ^ invalid.illegal
#            ^ keyword.operator.regexp.end
#             ^ meta.literal
#              ^^ constant.character.escape
#                ^^ keyword.other.backref-and-recursion.regexp-replacement
#                  ^^ constant.character.escape
#                    ^ meta.literal
#                     ^^ constant.character.escape
#                       ^ meta.literal
#                        ^ keyword.operator.replacement.end
#                         ^ keyword.other.caret.end

 ${1:default/no/regex$2/}
#^^^^^^^^^^^^^^^^^^^^^^^ meta.text-substitution
#   ^ keyword.operator.alternation.sublime-snippet-content
#    ^^^^^^^^^^^^^^^^^^^ string.unquoted.text-substitution
#           ^ - keyword
#              ^ - keyword
#                    ^ keyword.other.caret
#                     ^ constant.numeric

 $ 1.00
#^ invalid.illegal.unescaped-dollar

 ${0:$TM_SELECTED_TEXT}
#  ^ constant
#     ^^^^^^^^^^^^^^^^ constant
#   ^^ - constant
#                     ^ - constant

${My_Own_Constant}
# ^^^^^^^^^^^^^^^ constant.other

${1My_Own_Constant}
# ^^^^^^^^^^^^^^^^ constant.other

${10}
# ^^ constant.numeric

${1/test/abc/:substituation not valid here}
#  ^ keyword.operator.regexp.begin
#       ^ keyword.operator.regexp.end
#           ^ keyword.operator.replacement.end
#            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ invalid.illegal.unexpected-token
#                                         ^ keyword.other.caret.end - invalid

${1/test/escaped slash\/real slash/gx} x mode not supported properly in snippets
#  ^ keyword.operator.regexp.begin
#       ^ keyword.operator.regexp.end
#                     ^^ constant.character.escape
#                      ^ - keyword.operator.replacement.end
#                                 ^ keyword.operator.replacement.end
#                                  ^ storage.modifier.mode
#                                   ^ invalid.illegal.unexpected-token
#                                    ^ keyword.other.caret.end - invalid

It is possible to include a literal newline in the replacement: ${1/test/_
 /}.
#^ keyword.operator.replacement.end
# ^ keyword.other.caret.end

 ]]></content>
#^^^ string.unquoted.cdata punctuation.definition.string.end
#   ^^^^^^^^^^ meta.tag - string
#   ^^ punctuation.definition.tag.begin
#            ^ punctuation.definition.tag.end
    <!-- Optional: Tab trigger to activate the snippet -->
#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ comment
    <tabTrigger>test-snippet</tabTrigger>
#   ^^^^^^^^^^^^ meta.tag
    <!-- Optional: Scope the tab trigger will be active in -->
    <scope>text</scope>
</snippet>

<!-- NOTE: multiple payloads inside a sublime-snippet file are not supported
           but they are in this test file to avoid the need for using multiple
           test files, and to test the interactions between different scenarios
-->

<content> no cdata ${1} </content>
#                  ^^^^ meta.text-substitution
#                  ^^ keyword.other.caret
#                    ^ constant.numeric
#                     ^ keyword.other.caret
#                       ^^^^^^^^^^ meta.tag

<content>
    <![CDATA[ cdata on a
    different line ${1} ]]> </content>
#                  ^^^^ meta.text-substitution
#                  ^^ keyword.other.caret
#                    ^ constant.numeric
#                     ^ keyword.other.caret

<content>
    <![CDATA[ example ${1} ]]>
#                     ^^ keyword.other.caret
#                       ^ constant.numeric
#                        ^ keyword.other.caret

    <![CDATA[ example ${1} ]]>
#   ^^^^^^^^^^^^^^^^^^^^^^^^^^ invalid.illegal.multiple-cdata-not-allowed
#  ^ - invalid
#                             ^ - invalid
</content>
#^^^^^^^^^ meta.tag

<content>
    <![CDATA[ example </content> ${1} ]]>
#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ string
#                                        ^ - string
#                     ^^^^^^^^^^ - meta.tag
#                                ^^^^ meta.text-substitution
#                                ^^ keyword.other.caret
#                                  ^ constant.numeric
#                                   ^ keyword.other.caret
</content>
#^^^^^^^^^ meta.tag
